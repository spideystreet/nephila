# Nephila E2E test prompts — versioned interaction test cases.
# Each case has a prompt and assertions on the agent's final response.
#
# Fields:
#   id          : unique identifier
#   prompt      : user message sent to the agent
#   expect_warn : true if a critical interaction (Contre-indication / Association déconseillée) must be flagged
#   expect_in   : strings that MUST appear in the response (case-insensitive)
#   expect_not  : strings that must NOT appear (false-positive guard)

# --- expect_warn: true -------------------------------------------------------

# Pharmacodynamic CI: AINS potentiate MTX toxicity
- id: ibuprofene_methotrexate
  prompt: >
    Mon patient est suivi pour un psoriasis sous méthotrexate faible dose.
    Il a de la fièvre et demande s'il peut prendre de l'ibuprofène. Est-ce compatible ?
  expect_warn: true
  expect_in:
    - "⚠️"
    - "méthotrexate"
  expect_not:
    - "trimethoprime"
    - "probenecide"

# Pharmacokinetic CI: CYP3A4 inhibition → rhabdomyolysis risk
- id: simvastatine_clarithromycine
  prompt: >
    Patient sous simvastatine 40 mg pour une hypercholestérolémie.
    Son généraliste veut lui prescrire de la clarithromycine pour une bronchite.
    Y a-t-il un risque ?
  expect_warn: true
  expect_in:
    - "⚠️"
  expect_not: []

# Association déconseillée: anticoagulant + antiarrhythmic (INR potentiation)
- id: warfarine_amiodarone
  prompt: >
    Patient sous warfarine stable depuis 6 mois. Son cardiologue vient de lui prescrire
    de l'amiodarone pour une FA paroxystique. Y a-t-il une interaction à surveiller ?
  expect_warn: true
  expect_in:
    - "⚠️"
    - "amiodarone"
  expect_not:
    - "aspirine"
    - "fidaxomicine"

# --- expect_warn: false ------------------------------------------------------

# True negative: no known pharmacological interaction between these two drugs
- id: paracetamol_amoxicilline
  prompt: >
    Mon patient a une angine bactérienne traitée par amoxicilline.
    Il souhaite prendre du paracétamol pour la douleur et la fièvre.
    Y a-t-il une interaction entre ces deux médicaments ?
  expect_warn: false
  expect_in:
    - "paracétamol"
  expect_not:
    - "⚠️"
    - "contre-indication"

# Different tool path: tests search_drug → find_generics chain
- id: generiques_doliprane
  prompt: >
    Quels sont les médicaments génériques disponibles pour le Doliprane ?
  expect_warn: false
  expect_in:
    - "paracétamol"
  expect_not:
    - "⚠️"
